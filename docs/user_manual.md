# Adjustment Entries Automator 使用说明

## 1. 简介
Adjustment Entries Automator 是一个用于自动化处理调整分录的工具。它可以根据指定的账套名称，自动将调整分录录入到相应的 Excel 文件中，并生成处理结果和日志文件。

## 2. 安装与运行
### 2.1 环境要求
- Python 3.x
- 需要安装以下 Python 库：
  - `pandas`
  - `openpyxl`
  - `tkinter`

### 2.2 运行程序
1. 将代码保存为 `adjustment_automator.py` 文件。
2. 在命令行中运行以下命令启动程序：
  `python adjustment_automator.py`

### 3. 使用步骤

#### 3.1 选择工作文件夹
- 启动程序后，点击 `浏览...` 按钮选择工作文件夹。
- 工作文件夹将用于存储生成的配置文件和日志文件。

#### 3.2 生成配置文件
- 点击 `生成配置文件` 按钮，程序将在工作文件夹中生成 `配置文件` 和 `TB文件` 文件夹。
- `配置文件` 文件夹中包含两个 Excel 文件：
  - `调整分录.xlsx`：用于录入调整分录。
  - `路径表.xlsx`：用于指定账套文件的路径。

#### 3.3 选择路径表和调整分录文件
- 点击 `浏览...` 按钮选择 `路径表.xlsx` 文件。
- 点击 `浏览...` 按钮选择 `调整分录.xlsx` 文件。

#### 3.4 开始处理
- 点击 `开始处理` 按钮，程序将开始处理调整分录。
- 处理过程中，日志信息将显示在日志区域中。

#### 3.5 终止处理
- 如果需要终止处理，点击 `终止处理` 按钮。
- 处理终止后，程序将停止当前操作并生成日志文件。

#### 3.6 查看结果
- 处理完成后，程序将弹出一个窗口显示处理结果。
- 点击 `打开结果文件` 按钮可以查看生成的结果文件。
- 点击 `查看完整日志` 按钮可以查看完整的日志文件。

### 4. 注意事项
- 请确保 `路径表.xlsx` 和 `调整分录.xlsx` 文件的格式正确。
- 处理过程中请勿关闭程序，以免导致数据丢失。
- 如果处理过程中出现错误，请查看日志文件以获取详细信息。

### 5. 代码结构
- `edit_dataframe(df, group_column)`：根据指定列分组，并在每一组之间插入空行。
- `update_workbook(file_path)`：刷新工作簿以触发公式重新计算。
- `AdjustmentProcessor` 类：负责处理调整分录的主要逻辑。
- `AdjustmentApp` 类：负责用户界面的构建和事件处理。

### 6. 依赖库安装
如果尚未安装所需的 Python 库，可以使用以下命令进行安装：
`pip install pandas openpyxl`

### 7. 联系方式
如有任何问题或建议，请联系开发者。
